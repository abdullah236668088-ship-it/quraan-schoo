"use strict";(self.webpackChunkquran_memorization_web=self.webpackChunkquran_memorization_web||[]).push([[738],{2673:(e,a,s)=>{s.d(a,{A:()=>r});var t=s(5043),l=s(579);const r=e=>{let{isOpen:a,title:s,message:r,children:n,onConfirm:i,onCancel:o,showCancelButton:d=!0,closeOnOverlayClick:c=!1}=e;const u=(0,t.useRef)(null);if((0,t.useEffect)(()=>{if(a){var e;null===(e=u.current)||void 0===e||e.focus();const a=e=>{"Escape"===e.key&&o()};return document.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",a)}}},[a,o]),!a)return null;return(0,l.jsx)("div",{className:"modal-overlay",onClick:e=>{c&&u.current&&!u.current.contains(e.target)&&o()},children:(0,l.jsxs)("div",{className:"modal-content",ref:u,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title","aria-describedby":"modal-message",tabIndex:"-1",children:[(0,l.jsx)("h3",{id:"modal-title",className:"modal-title",children:s}),r&&(0,l.jsx)("p",{id:"modal-message",className:"modal-message",children:r}),n&&(0,l.jsx)("div",{className:"modal-body",children:n})," ",(0,l.jsxs)("div",{className:"modal-actions",children:[(0,l.jsx)("button",{onClick:i,className:"modal-confirm-button",children:"\u062a\u0623\u0643\u064a\u062f"}),d&&(0,l.jsx)("button",{onClick:o,className:"modal-cancel-button",children:"\u0625\u0644\u063a\u0627\u0621"})]})]})})}},8738:(e,a,s)=>{s.r(a),s.d(a,{default:()=>c});var t=s(5043),l=s(4973),r=s(6667),n=s(5016),i=s(2673),o=s(579);const d=["\u0627\u0644\u0641\u0627\u062a\u062d\u0629","\u0627\u0644\u0628\u0642\u0631\u0629","\u0622\u0644 \u0639\u0645\u0631\u0627\u0646","\u0627\u0644\u0646\u0633\u0627\u0621","\u0627\u0644\u0645\u0627\u0626\u062f\u0629","\u0627\u0644\u0623\u0646\u0639\u0627\u0645","\u0627\u0644\u0623\u0639\u0631\u0627\u0641","\u0627\u0644\u0623\u0646\u0641\u0627\u0644","\u0627\u0644\u062a\u0648\u0628\u0629","\u064a\u0648\u0646\u0633","\u0647\u0648\u062f","\u064a\u0648\u0633\u0641","\u0627\u0644\u0631\u0639\u062f","\u0625\u0628\u0631\u0627\u0647\u064a\u0645","\u0627\u0644\u062d\u062c\u0631","\u0627\u0644\u0646\u062d\u0644","\u0627\u0644\u0625\u0633\u0631\u0627\u0621","\u0627\u0644\u0643\u0647\u0641","\u0645\u0631\u064a\u0645","\u0637\u0647","\u0627\u0644\u0623\u0646\u0628\u064a\u0627\u0621","\u0627\u0644\u062d\u062c","\u0627\u0644\u0645\u0624\u0645\u0646\u0648\u0646","\u0627\u0644\u0646\u0648\u0631","\u0627\u0644\u0641\u0631\u0642\u0627\u0646","\u0627\u0644\u0634\u0639\u0631\u0627\u0621","\u0627\u0644\u0646\u0645\u0644","\u0627\u0644\u0642\u0635\u0635","\u0627\u0644\u0639\u0646\u0643\u0628\u0648\u062a","\u0627\u0644\u0631\u0648\u0645","\u0644\u0642\u0645\u0627\u0646","\u0627\u0644\u0633\u062c\u062f\u0629","\u0627\u0644\u0623\u062d\u0632\u0627\u0628","\u0633\u0628\u0623","\u0641\u0627\u0637\u0631","\u064a\u0633","\u0627\u0644\u0635\u0627\u0641\u0627\u062a","\u0635","\u0627\u0644\u0632\u0645\u0631","\u063a\u0627\u0641\u0631","\u0641\u0635\u0644\u062a","\u0627\u0644\u0634\u0648\u0631\u0649","\u0627\u0644\u0632\u062e\u0631\u0641","\u0627\u0644\u062f\u062e\u0627\u0646","\u0627\u0644\u062c\u0627\u062b\u064a\u0629","\u0627\u0644\u0623\u062d\u0642\u0627\u0641","\u0645\u062d\u0645\u062f","\u0627\u0644\u0641\u062a\u062d","\u0627\u0644\u062d\u062c\u0631\u0627\u062a","\u0642","\u0627\u0644\u0630\u0627\u0631\u064a\u0627\u062a","\u0627\u0644\u0637\u0648\u0631","\u0627\u0644\u0646\u062c\u0645","\u0627\u0644\u0642\u0645\u0631","\u0627\u0644\u0631\u062d\u0645\u0646","\u0627\u0644\u0648\u0627\u0642\u0639\u0629","\u0627\u0644\u062d\u062f\u064a\u062f","\u0627\u0644\u0645\u062c\u0627\u062f\u0644\u0629","\u0627\u0644\u062d\u0634\u0631","\u0627\u0644\u0645\u0645\u062a\u062d\u0646\u0629","\u0627\u0644\u0635\u0641","\u0627\u0644\u062c\u0645\u0639\u0629","\u0627\u0644\u0645\u0646\u0627\u0641\u0642\u0648\u0646","\u0627\u0644\u062a\u063a\u0627\u0628\u0646","\u0627\u0644\u0637\u0644\u0627\u0642","\u0627\u0644\u062a\u062d\u0631\u064a\u0645","\u0627\u0644\u0645\u0644\u0643","\u0627\u0644\u0642\u0644\u0645","\u0627\u0644\u062d\u0627\u0642\u0629","\u0627\u0644\u0645\u0639\u0627\u0631\u062c","\u0646\u0648\u062d","\u0627\u0644\u062c\u0646","\u0627\u0644\u0645\u0632\u0645\u0644","\u0627\u0644\u0645\u062f\u062b\u0631","\u0627\u0644\u0642\u064a\u0627\u0645\u0629","\u0627\u0644\u0625\u0646\u0633\u0627\u0646","\u0627\u0644\u0645\u0631\u0633\u0644\u0627\u062a","\u0627\u0644\u0646\u0628\u0623","\u0627\u0644\u0646\u0627\u0632\u0639\u0627\u062a","\u0639\u0628\u0633","\u0627\u0644\u062a\u0643\u0648\u064a\u0631","\u0627\u0644\u0625\u0646\u0641\u0637\u0627\u0631","\u0627\u0644\u0645\u0637\u0641\u0641\u064a\u0646","\u0627\u0644\u0625\u0646\u0634\u0642\u0627\u0642","\u0627\u0644\u0628\u0631\u0648\u062c","\u0627\u0644\u0637\u0627\u0631\u0642","\u0627\u0644\u0623\u0639\u0644\u0649","\u0627\u0644\u063a\u0627\u0634\u064a\u0629","\u0627\u0644\u0641\u062c\u0631","\u0627\u0644\u0628\u0644\u062f","\u0627\u0644\u0634\u0645\u0633","\u0627\u0644\u0644\u064a\u0644","\u0627\u0644\u0636\u062d\u0649","\u0627\u0644\u0634\u0631\u062d","\u0627\u0644\u062a\u064a\u0646","\u0627\u0644\u0639\u0644\u0642","\u0627\u0644\u0642\u062f\u0631","\u0627\u0644\u0628\u064a\u0646\u0629","\u0627\u0644\u0632\u0644\u0632\u0644\u0629","\u0627\u0644\u0639\u0627\u062f\u064a\u0627\u062a","\u0627\u0644\u0642\u0627\u0631\u0639\u0629","\u0627\u0644\u062a\u0643\u0627\u062b\u0631","\u0627\u0644\u0639\u0635\u0631","\u0627\u0644\u0647\u0645\u0632\u0629","\u0627\u0644\u0641\u064a\u0644","\u0642\u0631\u064a\u0634","\u0627\u0644\u0645\u0627\u0639\u0648\u0646","\u0627\u0644\u0643\u0648\u062b\u0631","\u0627\u0644\u0643\u0627\u0641\u0631\u0648\u0646","\u0627\u0644\u0646\u0635\u0631","\u0627\u0644\u0645\u0633\u062f","\u0627\u0644\u0625\u062e\u0644\u0627\u0635","\u0627\u0644\u0641\u0644\u0642","\u0627\u0644\u0646\u0627\u0633"];function c(){const{currentUser:e,userRole:a}=(0,n.A)(),[s,c]=(0,t.useState)([]),[u,m]=(0,t.useState)([]),[h,p]=(0,t.useState)(""),[g,f]=(0,t.useState)(""),[x,b]=(0,t.useState)(""),[v,j]=(0,t.useState)(0),[N,C]=(0,t.useState)(0),[y,w]=(0,t.useState)(0),[k,S]=(0,t.useState)(""),[q,E]=(0,t.useState)(!0),[z,I]=(0,t.useState)(""),[F,M]=(0,t.useState)(""),[A,O]=(0,t.useState)(!1),[_,D]=(0,t.useState)({}),[B,L]=(0,t.useState)(""),[R,J]=(0,t.useState)([]),H=(0,t.useCallback)(()=>{const e=v/10*40+N/5*30+y/6*30;return Math.min(100,Math.round(e))},[v,N,y]);(0,t.useEffect)(()=>{if(!e||!e.uid||"teacher"!==a)return E(!1),void I("\u0644\u064a\u0633 \u0644\u062f\u064a\u0643 \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0629 \u0644\u0625\u0636\u0627\u0641\u0629 \u062a\u0642\u0627\u0631\u064a\u0631 \u0623\u0633\u0628\u0648\u0639\u064a\u0629.");E(!0),I("");let s=()=>{},t=[];const n=e=>{if(0===e.length)return c([]),E(!1),[];const a=[],s=[];for(let l=0;l<e.length;l+=10)s.push(e.slice(l,l+10));const t=new Map;let n=0;return s.forEach((e,i)=>{const o=(0,r.P)((0,r.rJ)(l.db,"students"),(0,r._M)("halaqaId","in",e)),d=(0,r.aQ)(o,e=>{const a=e.docs.map(e=>({id:e.id,...e.data()}));if(t.set(i,a),n<s.length&&n++,n===s.length){const e=Array.from(t.values()).flat(),a=Array.from(new Map(e.map(e=>[e.id,e])).values());c(a),E(!1)}},e=>{console.error(`Error fetching students for chunk ${i} in real-time:`,e),I("\u0641\u0634\u0644 \u0641\u064a \u062c\u0644\u0628 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0637\u0644\u0627\u0628 \u0641\u064a \u0627\u0644\u0648\u0642\u062a \u0627\u0644\u0641\u0639\u0644\u064a: "+e.message),E(!1)});a.push(d)}),a};return(()=>{const a=(0,r.P)((0,r.rJ)(l.db,"halaqat"),(0,r._M)("teacherId","==",e.uid));s=(0,r.aQ)(a,e=>{const a=e.docs.map(e=>({id:e.id,...e.data()}));m(a);const s=a.map(e=>e.id);t.forEach(e=>e()),t=[],s.length>0?t=n(s):(c([]),E(!1))},e=>{console.error("Error fetching halaqat in real-time:",e),I("\u0641\u0634\u0644 \u0641\u064a \u062c\u0644\u0628 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u062d\u0644\u0642\u0627\u062a \u0641\u064a \u0627\u0644\u0648\u0642\u062a \u0627\u0644\u0641\u0639\u0644\u064a: "+e.message),E(!1)})})(),()=>{s(),t.forEach(e=>e())}},[e,a]);const P=(0,t.useCallback)(()=>g?s.filter(e=>e.halaqaId===g):s,[s,g]),Q=(0,t.useCallback)(()=>{p(""),f(""),b(""),j(0),C(0),w(0),S(""),L(""),J([]),I(""),M("")},[]),U=(0,t.useCallback)(e=>{const a=e.target.value;if(L(a),a.length>0){const e=d.filter(e=>e.toLowerCase().includes(a.toLowerCase()));J(e)}else J([])},[]),$=(0,t.useCallback)(e=>{L(e),J([])},[]),G=(0,t.useCallback)(async a=>{if(a.preventDefault(),I(""),M(""),h&&g&&x)if(v<0||N<0||y<0||y>6)I("\u0627\u0644\u0631\u062c\u0627\u0621 \u0625\u062f\u062e\u0627\u0644 \u0642\u064a\u0645 \u0635\u062d\u064a\u062d\u0629 \u0644\u0644\u062d\u0641\u0638 \u0648\u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629 \u0648\u0623\u064a\u0627\u0645 \u0627\u0644\u062d\u0636\u0648\u0631 (0-6).");else{E(!0);try{const a=await(0,r.x7)((0,r.H9)(l.db,"students",h)),s=a.exists()?a.data():null;if(!s)return I("\u0627\u0644\u0637\u0627\u0644\u0628 \u0627\u0644\u0645\u062d\u062f\u062f \u063a\u064a\u0631 \u0645\u0648\u062c\u0648\u062f."),void E(!1);await updateDoc((0,r.H9)(l.db,"students",h),{memorization:B||s.memorization}),await(0,r.gS)((0,r.rJ)(l.db,"weeklyReports"),{studentId:h,halaqaId:g,teacherId:e.uid,reportDate:new Date(x),pagesMemorized:parseInt(v),partsRevised:parseInt(N),attendanceDays:parseInt(y),rating:H(),notes:k,createdAt:(0,r.O5)()}),D({title:"\u062a\u0642\u0631\u064a\u0631 \u0623\u0633\u0628\u0648\u0639\u064a",message:"\u062a\u0645 \u062d\u0641\u0638 \u0627\u0644\u062a\u0642\u0631\u064a\u0631 \u0627\u0644\u0623\u0633\u0628\u0648\u0639\u064a \u0628\u0646\u062c\u0627\u062d!",onConfirm:()=>{O(!1),Q()},showCancelButton:!1}),O(!0)}catch(s){console.error("Error submitting weekly report:",s),I("\u0641\u0634\u0644 \u0641\u064a \u062d\u0641\u0638 \u0627\u0644\u062a\u0642\u0631\u064a\u0631: "+s.message)}finally{E(!1)}}else I("\u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u062e\u062a\u064a\u0627\u0631 \u0627\u0644\u0637\u0627\u0644\u0628 \u0648\u0627\u0644\u062d\u0644\u0642\u0629 \u0648\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u062a\u0642\u0631\u064a\u0631.")},[h,g,x,v,N,y,k,B,H,e,Q]);return"teacher"!==a?(0,o.jsx)("p",{className:"unauthorized-message",children:"\u0644\u064a\u0633 \u0644\u062f\u064a\u0643 \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0629 \u0644\u0625\u0636\u0627\u0641\u0629 \u062a\u0642\u0627\u0631\u064a\u0631 \u0623\u0633\u0628\u0648\u0639\u064a\u0629."}):q?(0,o.jsx)("p",{className:"loading-message",children:"\u062c\u0627\u0631\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a..."}):(0,o.jsxs)("div",{className:"weekly-reports-container page-container",children:[(0,o.jsx)("h2",{className:"weekly-reports-title",children:"\u0625\u0636\u0627\u0641\u0629 \u062a\u0642\u0631\u064a\u0631 \u0623\u0633\u0628\u0648\u0639\u064a"}),z&&(0,o.jsx)("p",{className:"error-message",children:z}),F&&(0,o.jsx)("p",{className:"success-message",children:F}),(0,o.jsxs)("form",{onSubmit:G,className:"report-form card",children:[(0,o.jsxs)("div",{className:"form-grid",children:[(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"halaqa-select",children:"\u0627\u062e\u062a\u0631 \u0627\u0644\u062d\u0644\u0642\u0629:"}),(0,o.jsxs)("select",{id:"halaqa-select",value:g,onChange:e=>{f(e.target.value),p("")},className:"form-select",required:!0,disabled:q,children:[(0,o.jsx)("option",{value:"",children:"\u0627\u062e\u062a\u0631 \u062d\u0644\u0642\u0629"}),u.map(e=>(0,o.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"student-select",children:"\u0627\u062e\u062a\u0631 \u0627\u0644\u0637\u0627\u0644\u0628:"}),(0,o.jsxs)("select",{id:"student-select",value:h,onChange:e=>p(e.target.value),className:"form-select",required:!0,disabled:q||!g,children:[(0,o.jsx)("option",{value:"",children:"\u0627\u062e\u062a\u0631 \u0637\u0627\u0644\u0628"}),P().map(e=>(0,o.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"report-date",children:"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u062a\u0642\u0631\u064a\u0631:"}),(0,o.jsx)("input",{type:"date",id:"report-date",value:x,onChange:e=>b(e.target.value),className:"form-input",required:!0,disabled:q})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"pages-memorized",children:"\u0627\u0644\u0635\u0641\u062d\u0627\u062a \u0627\u0644\u0645\u062d\u0641\u0648\u0638\u0629:"}),(0,o.jsx)("input",{type:"number",id:"pages-memorized",min:"0",value:v,onChange:e=>j(e.target.value),className:"form-input",required:!0,disabled:q})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"parts-revised",children:"\u0627\u0644\u0623\u062c\u0632\u0627\u0621 \u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629:"}),(0,o.jsx)("input",{type:"number",id:"parts-revised",min:"0",value:N,onChange:e=>C(e.target.value),className:"form-input",required:!0,disabled:q})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"attendance-days",children:"\u0623\u064a\u0627\u0645 \u0627\u0644\u062d\u0636\u0648\u0631 (0-6):"}),(0,o.jsx)("input",{type:"number",id:"attendance-days",min:"0",max:"6",value:y,onChange:e=>w(e.target.value),className:"form-input",required:!0,disabled:q})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"new-memorization",children:"\u0627\u0644\u062d\u0641\u0638 \u0627\u0644\u062c\u062f\u064a\u062f (\u0627\u0633\u0645 \u0627\u0644\u0633\u0648\u0631\u0629):"}),(0,o.jsx)("input",{type:"text",id:"new-memorization",value:B,onChange:U,placeholder:"\u0645\u062b\u0627\u0644: \u0627\u0644\u0628\u0642\u0631\u0629",className:"form-input",disabled:q}),R.length>0&&B.length>0&&(0,o.jsx)("ul",{className:"autocomplete-results",children:R.map((e,a)=>(0,o.jsx)("li",{onClick:()=>$(e),children:e},a))})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"rating",children:"\u0627\u0644\u062a\u0642\u064a\u064a\u0645 (0-100):"}),(0,o.jsx)("input",{type:"number",id:"rating",min:"0",max:"100",value:H(),readOnly:!0,className:"form-input read-only-input",disabled:q})]}),(0,o.jsxs)("div",{className:"form-group full-width",children:[(0,o.jsx)("label",{htmlFor:"notes",children:"\u0645\u0644\u0627\u062d\u0638\u0627\u062a:"}),(0,o.jsx)("textarea",{id:"notes",value:k,onChange:e=>S(e.target.value),className:"form-textarea",disabled:q})]})]}),(0,o.jsx)("button",{type:"submit",className:"submit-button",disabled:q,children:q?"\u062c\u0627\u0631\u064a \u0627\u0644\u062d\u0641\u0638...":"\u062d\u0641\u0638 \u0627\u0644\u062a\u0642\u0631\u064a\u0631"})]}),(0,o.jsx)(i.A,{isOpen:A,title:_.title,message:_.message,onConfirm:_.onConfirm,onCancel:_.onCancel,showCancelButton:_.showCancelButton})]})}}}]);
//# sourceMappingURL=738.6eb781ef.chunk.js.map