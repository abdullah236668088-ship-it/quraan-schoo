"use strict";(self.webpackChunkquran_memorization_web=self.webpackChunkquran_memorization_web||[]).push([[60],{2673:(e,a,s)=>{s.d(a,{A:()=>l});var t=s(5043),n=s(579);const l=e=>{let{isOpen:a,title:s,message:l,children:r,onConfirm:c,onCancel:i,showCancelButton:d=!0,closeOnOverlayClick:o=!1}=e;const m=(0,t.useRef)(null);if((0,t.useEffect)(()=>{if(a){var e;null===(e=m.current)||void 0===e||e.focus();const a=e=>{"Escape"===e.key&&i()};return document.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",a)}}},[a,i]),!a)return null;return(0,n.jsx)("div",{className:"modal-overlay",onClick:e=>{o&&m.current&&!m.current.contains(e.target)&&i()},children:(0,n.jsxs)("div",{className:"modal-content",ref:m,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title","aria-describedby":"modal-message",tabIndex:"-1",children:[(0,n.jsx)("h3",{id:"modal-title",className:"modal-title",children:s}),l&&(0,n.jsx)("p",{id:"modal-message",className:"modal-message",children:l}),r&&(0,n.jsx)("div",{className:"modal-body",children:r})," ",(0,n.jsxs)("div",{className:"modal-actions",children:[(0,n.jsx)("button",{onClick:c,className:"modal-confirm-button",children:"\u062a\u0623\u0643\u064a\u062f"}),d&&(0,n.jsx)("button",{onClick:i,className:"modal-cancel-button",children:"\u0625\u0644\u063a\u0627\u0621"})]})]})})}},5060:(e,a,s)=>{s.r(a),s.d(a,{default:()=>d});var t=s(5043),n=s(4973),l=s(6667),r=s(5016),c=s(2673),i=s(579);function d(){const{userRole:e}=(0,r.A)(),[a,s]=(0,t.useState)([]),[d,o]=(0,t.useState)(""),[m,u]=(0,t.useState)(null),[h,b]=(0,t.useState)(""),[x,j]=(0,t.useState)(!0),[g,N]=(0,t.useState)(""),[f,C]=(0,t.useState)(""),[v,p]=(0,t.useState)(!1),[k,w]=(0,t.useState)({});(0,t.useEffect)(()=>{if("admin"!==e)return j(!1),void N("\u0644\u064a\u0633 \u0644\u062f\u064a\u0643 \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0629 \u0644\u0644\u0648\u0635\u0648\u0644 \u0625\u0644\u0649 \u0647\u0630\u0647 \u0627\u0644\u0635\u0641\u062d\u0629.");j(!0),N("");const a=(0,l.rJ)(n.db,"users"),t=(0,l.P)(a,(0,l._M)("role","==","teacher")),r=(0,l.aQ)(t,e=>{const a=[];e.forEach(e=>{a.push({id:e.id,...e.data()})}),s(a),j(!1)},e=>{console.error("Error fetching teachers in real-time:",e),N("\u0641\u0634\u0644 \u0641\u064a \u062c\u0644\u0628 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0639\u0644\u0645\u064a\u0646 \u0641\u064a \u0627\u0644\u0648\u0642\u062a \u0627\u0644\u0641\u0639\u0644\u064a: "+e.message),j(!1)});return()=>r()},[e]);const y=(0,t.useCallback)(async()=>{if(N(""),C(""),d.trim()){j(!0);try{const e=(0,l.P)((0,l.rJ)(n.db,"users"),(0,l._M)("name","==",d.trim()),(0,l._M)("role","==","teacher"));if(!(await(0,l.GG)(e)).empty)return N("\u0647\u0630\u0627 \u0627\u0644\u0645\u0639\u0644\u0645 \u0645\u0648\u062c\u0648\u062f \u0628\u0627\u0644\u0641\u0639\u0644."),void j(!1);await(0,l.gS)((0,l.rJ)(n.db,"users"),{name:d.trim(),role:"teacher",createdAt:new Date}),o(""),C("\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0645\u0639\u0644\u0645 \u0628\u0646\u062c\u0627\u062d! (\u062a\u0623\u0643\u062f \u0645\u0646 \u0648\u062c\u0648\u062f \u062d\u0633\u0627\u0628 \u0645\u0635\u0627\u062f\u0642\u0629 \u0644\u0647\u0630\u0627 \u0627\u0644\u0645\u0639\u0644\u0645)")}catch(e){console.error("Error adding teacher:",e),N("\u0641\u0634\u0644 \u0641\u064a \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0645\u0639\u0644\u0645: "+e.message)}finally{j(!1)}}else N("\u064a\u0631\u062c\u0649 \u0625\u062f\u062e\u0627\u0644 \u0627\u0633\u0645 \u0627\u0644\u0645\u0639\u0644\u0645.")},[d]),_=(0,t.useCallback)(e=>{u(e.id),b(e.name),N(""),C("")},[]),E=(0,t.useCallback)(async e=>{if(N(""),C(""),h.trim()){j(!0);try{const a=(0,l.P)((0,l.rJ)(n.db,"users"),(0,l._M)("name","==",h.trim()),(0,l._M)("role","==","teacher")),s=await(0,l.GG)(a);if(s.docs.some(a=>a.id!==e))return N("\u0647\u0630\u0627 \u0627\u0644\u0645\u0639\u0644\u0645 \u0645\u0648\u062c\u0648\u062f \u0628\u0627\u0644\u0641\u0639\u0644."),void j(!1);const t=(0,l.H9)(n.db,"users",e);await(0,l.mZ)(t,{name:h.trim()}),C("\u062a\u0645 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0645\u0639\u0644\u0645 \u0628\u0646\u062c\u0627\u062d!"),u(null),b("")}catch(a){console.error("Error updating teacher:",a),N("\u0641\u0634\u0644 \u0641\u064a \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0645\u0639\u0644\u0645: "+a.message)}finally{j(!1)}}else N("\u064a\u0631\u062c\u0649 \u0625\u062f\u062e\u0627\u0644 \u0627\u0633\u0645 \u0627\u0644\u0645\u0639\u0644\u0645.")},[h]),S=(0,t.useCallback)(e=>{w({title:"\u062a\u0623\u0643\u064a\u062f \u0627\u0644\u062d\u0630\u0641",message:"\u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0623\u0646\u0643 \u062a\u0631\u064a\u062f \u062d\u0630\u0641 \u0647\u0630\u0627 \u0627\u0644\u0645\u0639\u0644\u0645\u061f \u0633\u064a\u062a\u0645 \u0625\u0644\u063a\u0627\u0621 \u0631\u0628\u0637 \u062c\u0645\u064a\u0639 \u0627\u0644\u062d\u0644\u0642\u0627\u062a \u0627\u0644\u0645\u0631\u062a\u0628\u0637\u0629 \u0628\u0647. (\u0644\u0627 \u064a\u0624\u062b\u0631 \u0647\u0630\u0627 \u0639\u0644\u0649 \u062d\u0633\u0627\u0628 \u0627\u0644\u0645\u0635\u0627\u062f\u0642\u0629 \u0627\u0644\u062e\u0627\u0635 \u0628\u0647 \u0641\u064a Firebase Auth).",onConfirm:async()=>{p(!1),j(!0),N(""),C("");try{const a=(0,l.P)((0,l.rJ)(n.db,"halaqat"),(0,l._M)("teacherId","==",e)),s=(await(0,l.GG)(a)).docs.map(e=>(0,l.mZ)((0,l.H9)(n.db,"halaqat",e.id),{teacherId:null,teacherName:null}));await Promise.all(s);const t=(0,l.P)((0,l.rJ)(n.db,"students"),(0,l._M)("teacherId","==",e)),r=(await(0,l.GG)(t)).docs.map(e=>(0,l.mZ)((0,l.H9)(n.db,"students",e.id),{teacherId:null}));await Promise.all(r),await(0,l.kd)((0,l.H9)(n.db,"users",e)),C("\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0645\u0639\u0644\u0645 \u0648\u062a\u062d\u062f\u064a\u062b \u0627\u0644\u062d\u0644\u0642\u0627\u062a \u0648\u0627\u0644\u0637\u0644\u0627\u0628 \u0627\u0644\u0645\u0631\u062a\u0628\u0637\u064a\u0646 \u0628\u0646\u062c\u0627\u062d!")}catch(a){console.error("Error deleting teacher or updating associated data:",a),N("\u0641\u0634\u0644 \u0641\u064a \u062d\u0630\u0641 \u0627\u0644\u0645\u0639\u0644\u0645: "+a.message)}finally{j(!1)}},onCancel:()=>p(!1),showCancelButton:!0}),p(!0)},[]);return"admin"!==e?(0,i.jsx)("div",{className:"unauthorized-message",children:"\u0644\u064a\u0633 \u0644\u062f\u064a\u0643 \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0629 \u0644\u0644\u0648\u0635\u0648\u0644 \u0625\u0644\u0649 \u0647\u0630\u0647 \u0627\u0644\u0635\u0641\u062d\u0629."}):x?(0,i.jsx)("p",{className:"loading-message",children:"\u062c\u0627\u0631\u064a \u062a\u062d\u0645\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0639\u0644\u0645\u064a\u0646..."}):(0,i.jsxs)("div",{className:"teachers-container page-container",children:[(0,i.jsx)("h2",{className:"teachers-title",children:"\u0625\u062f\u0627\u0631\u0629 \u0627\u0644\u0645\u0639\u0644\u0645\u064a\u0646"}),g&&(0,i.jsx)("p",{className:"error-message",children:g}),f&&(0,i.jsx)("p",{className:"success-message",children:f}),(0,i.jsxs)("div",{className:"teachers-list-section card",children:[(0,i.jsx)("h3",{children:"\u0627\u0644\u0645\u0639\u0644\u0645\u0648\u0646 \u0627\u0644\u062d\u0627\u0644\u064a\u0648\u0646"}),0===a.length?(0,i.jsx)("p",{className:"no-data-message",children:"\u0644\u0627 \u064a\u0648\u062c\u062f \u0645\u0639\u0644\u0645\u0648\u0646 \u0645\u0633\u062c\u0644\u0648\u0646 \u062d\u0627\u0644\u064a\u064b\u0627."}):(0,i.jsx)("ul",{className:"teachers-list",children:a.map(e=>(0,i.jsx)("li",{className:"teacher-item",children:m===e.id?(0,i.jsxs)("div",{className:"edit-teacher-form",children:[(0,i.jsx)("input",{type:"text",value:h,onChange:e=>b(e.target.value),className:"edit-teacher-input",required:!0}),(0,i.jsx)("button",{onClick:()=>E(e.id),className:"save-button",disabled:x,children:x?"\u062c\u0627\u0631\u064a \u0627\u0644\u062d\u0641\u0638...":"\u062d\u0641\u0638"}),(0,i.jsx)("button",{onClick:()=>{u(null),N(""),C("")},className:"cancel-button",disabled:x,children:"\u0625\u0644\u063a\u0627\u0621"})]}):(0,i.jsxs)("div",{className:"teacher-details",children:[(0,i.jsx)("strong",{children:e.name}),(0,i.jsxs)("div",{className:"teacher-actions",children:[(0,i.jsx)("button",{onClick:()=>_(e),className:"edit-button",children:"\u062a\u0639\u062f\u064a\u0644"}),(0,i.jsx)("button",{onClick:()=>S(e.id),className:"delete-button",children:"\u062d\u0630\u0641"})]})]})},e.id))})]}),(0,i.jsxs)("div",{className:"add-teacher-section card",children:[(0,i.jsx)("h3",{children:"\u0625\u0636\u0627\u0641\u0629 \u0645\u0639\u0644\u0645 \u062c\u062f\u064a\u062f"}),(0,i.jsx)("input",{type:"text",placeholder:"\u0627\u0633\u0645 \u0627\u0644\u0645\u0639\u0644\u0645 \u0627\u0644\u062c\u062f\u064a\u062f",value:d,onChange:e=>o(e.target.value),className:"new-teacher-input",required:!0}),(0,i.jsx)("button",{onClick:y,className:"add-teacher-button",disabled:x,children:x?"\u062c\u0627\u0631\u064a \u0627\u0644\u0625\u0636\u0627\u0641\u0629...":"\u0625\u0636\u0627\u0641\u0629 \u0645\u0639\u0644\u0645 \u062c\u062f\u064a\u062f"})]}),(0,i.jsx)(c.A,{isOpen:v,title:k.title,message:k.message,onConfirm:k.onConfirm,onCancel:k.onCancel,showCancelButton:k.showCancelButton})]})}}}]);
//# sourceMappingURL=60.812c7537.chunk.js.map