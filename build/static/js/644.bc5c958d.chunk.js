"use strict";(self.webpackChunkquran_memorization_web=self.webpackChunkquran_memorization_web||[]).push([[644],{5644:(e,r,t)=>{t.r(r),t.d(r,{default:()=>d});var a=t(5043),s=t(6058),o=t(4973),n=t(6667),l=t(5016),i=t(7304),c=t(579);function d(){const{userRole:e,currentUser:r}=(0,l.A)(),[t,i]=(0,a.useState)(null),[d,u]=(0,a.useState)(!0),[h,p]=(0,a.useState)(""),g=(0,a.useCallback)(async()=>{if(u(!0),p(""),!r||!r.uid)return i(null),void u(!1);let t;if("teacher"===e)try{const e=(0,n.P)((0,n.rJ)(o.db,"students"),(0,n._M)("teacherId","==",r.uid)),a=(await(0,n.GG)(e)).docs.map(e=>e.id);if(0===a.length)return i(null),void u(!1);t=(0,n.P)((0,n.rJ)(o.db,"weeklyReports"),(0,n._M)("studentId","in",a))}catch(a){return console.error("Error fetching teacher's students or reports:",a),p("\u0641\u0634\u0644 \u0641\u064a \u062c\u0644\u0628 \u062a\u0642\u0627\u0631\u064a\u0631 \u0627\u0644\u0637\u0644\u0627\u0628 \u0644\u0644\u0645\u0639\u0644\u0645: "+a.message),void u(!1)}else{if("admin"!==e)return i(null),void u(!1);t=(0,n.rJ)(o.db,"weeklyReports")}try{const e=await(0,n.GG)(t),r={};e.forEach(e=>{const t=e.data(),a=new Date(t.reportDate.toDate()),s=`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")}`;r[s]||(r[s]=0),r[s]+=t.pagesMemorized||0});const a=Object.keys(r).sort(),s=a.map(e=>r[e]);a.length>0?i({labels:a,datasets:[{label:"\u0639\u062f\u062f \u0627\u0644\u0635\u0641\u062d\u0627\u062a \u0627\u0644\u0645\u062d\u0641\u0648\u0638\u0629",data:s,fill:!1,borderColor:"rgb(75, 192, 192)",tension:.1,pointBackgroundColor:"rgb(75, 192, 192)",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgb(75, 192, 192)"}]}):i(null)}catch(a){console.error("Error processing chart data:",a),p("\u0641\u0634\u0644 \u0641\u064a \u0645\u0639\u0627\u0644\u062c\u0629 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0631\u0633\u0645 \u0627\u0644\u0628\u064a\u0627\u0646\u064a: "+a.message)}finally{u(!1)}},[e,r]);return(0,a.useEffect)(()=>{g()},[g]),d?(0,c.jsx)("p",{className:"loading-message",children:"\u062c\u0627\u0631\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a..."}):h?(0,c.jsx)("p",{className:"error-message",children:h}):(0,c.jsxs)("div",{className:"charts-container page-container",children:[(0,c.jsx)("h2",{className:"charts-title",children:"\u0627\u0644\u0631\u0633\u0648\u0645 \u0627\u0644\u0628\u064a\u0627\u0646\u064a\u0629 \u0644\u0625\u0646\u062c\u0627\u0632 \u0627\u0644\u0637\u0644\u0627\u0628"}),t&&t.labels.length>0?(0,c.jsx)("div",{className:"chart-container",children:(0,c.jsx)(s.N1,{data:t,options:{responsive:!0,maintainAspectRatio:!1}})}):(0,c.jsx)("p",{className:"no-chart-data",children:"\u0644\u0627 \u062a\u0648\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u0644\u0639\u0631\u0636\u0647\u0627 \u062d\u0627\u0644\u064a\u064b\u0627. \u062a\u0623\u0643\u062f \u0645\u0646 \u0648\u062c\u0648\u062f \u062a\u0642\u0627\u0631\u064a\u0631 \u0623\u0633\u0628\u0648\u0639\u064a\u0629 \u0644\u0644\u0637\u0644\u0627\u0628."})]})}i.t1.register(i.PP,i.kc,i.FN,i.No,i.hE,i.m_,i.s$)}}]);
//# sourceMappingURL=644.bc5c958d.chunk.js.map