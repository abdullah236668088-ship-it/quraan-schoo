"use strict";(self.webpackChunkquran_memorization_web=self.webpackChunkquran_memorization_web||[]).push([[973],{2673:(e,s,a)=>{a.d(s,{A:()=>n});var t=a(5043),l=a(579);const n=e=>{let{isOpen:s,title:a,message:n,children:i,onConfirm:c,onCancel:r,showCancelButton:d=!0,closeOnOverlayClick:o=!1}=e;const m=(0,t.useRef)(null);if((0,t.useEffect)(()=>{if(s){var e;null===(e=m.current)||void 0===e||e.focus();const s=e=>{"Escape"===e.key&&r()};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}}},[s,r]),!s)return null;return(0,l.jsx)("div",{className:"modal-overlay",onClick:e=>{o&&m.current&&!m.current.contains(e.target)&&r()},children:(0,l.jsxs)("div",{className:"modal-content",ref:m,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title","aria-describedby":"modal-message",tabIndex:"-1",children:[(0,l.jsx)("h3",{id:"modal-title",className:"modal-title",children:a}),n&&(0,l.jsx)("p",{id:"modal-message",className:"modal-message",children:n}),i&&(0,l.jsx)("div",{className:"modal-body",children:i})," ",(0,l.jsxs)("div",{className:"modal-actions",children:[(0,l.jsx)("button",{onClick:c,className:"modal-confirm-button",children:"\u062a\u0623\u0643\u064a\u062f"}),d&&(0,l.jsx)("button",{onClick:r,className:"modal-cancel-button",children:"\u0625\u0644\u063a\u0627\u0621"})]})]})})}},7973:(e,s,a)=>{a.r(s),a.d(s,{default:()=>o});var t=a(5043),l=a(5016),n=a(4973),i=a(6667),c=a(5982),r=a(2673),d=a(579);function o(){const{currentUser:e,userRole:s,loading:a}=(0,l.A)(),o=(0,c.xI)(),[m,u]=(0,t.useState)(""),[h,x]=(0,t.useState)([]),[j,p]=(0,t.useState)([]),[f,g]=(0,t.useState)(!0),[b,N]=(0,t.useState)(""),[C,v]=(0,t.useState)(""),[y,k]=(0,t.useState)(!1),[w,S]=(0,t.useState)(!1),[E,H]=(0,t.useState)({}),q=(0,t.useCallback)(async()=>{if(e&&!a){g(!0),N(""),v("");try{const s=(0,i.H9)(n.db,"users",e.uid),a=await(0,i.x7)(s);if(a.exists()){const s=a.data();if(u(s.name||e.displayName||e.email),"teacher"===s.role&&s.associatedHalaqat&&s.associatedHalaqat.length>0){const e=s.associatedHalaqat.map(e=>(0,i.x7)((0,i.H9)(n.db,"halaqat",e))),a=(await Promise.all(e)).map(e=>e.exists()?e.data().name:"\u062d\u0644\u0642\u0629 \u063a\u064a\u0631 \u0645\u0639\u0631\u0648\u0641\u0629");x(a)}else x([]);if("guest"===s.role&&s.associatedStudents&&s.associatedStudents.length>0){const e=s.associatedStudents.map(e=>(0,i.x7)((0,i.H9)(n.db,"students",e))),a=(await Promise.all(e)).map(e=>e.exists()?e.data().name:"\u0637\u0627\u0644\u0628 \u063a\u064a\u0631 \u0645\u0639\u0631\u0648\u0641");p(a)}else p([])}else u(e.displayName||e.email)}catch(s){console.error("Error fetching user profile:",s),N("\u0641\u0634\u0644 \u062c\u0644\u0628 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0644\u0641 \u0627\u0644\u0634\u062e\u0635\u064a: "+s.message)}finally{g(!1)}}else g(!1)},[e,a]);(0,t.useEffect)(()=>{q()},[q]);const B=(0,t.useCallback)(async()=>{if(N(""),v(""),m.trim()){g(!0);try{const s=(0,i.H9)(n.db,"users",e.uid);await(0,i.mZ)(s,{name:m.trim()}),e.displayName!==m.trim()&&await e.updateProfile({displayName:m.trim()}),v("\u062a\u0645 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0627\u0633\u0645 \u0628\u0646\u062c\u0627\u062d!"),k(!1)}catch(s){console.error("Error updating profile name:",s),N("\u0641\u0634\u0644 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0627\u0633\u0645: "+s.message)}finally{g(!1)}}else N("\u0627\u0644\u0627\u0633\u0645 \u0644\u0627 \u064a\u0645\u0643\u0646 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0641\u0627\u0631\u063a\u0627\u064b.")},[m,e]),O=(0,t.useCallback)(()=>{e&&e.email?(H({title:"\u0625\u0639\u0627\u062f\u0629 \u062a\u0639\u064a\u064a\u0646 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631",message:`\u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0623\u0646\u0643 \u062a\u0631\u064a\u062f \u0625\u0631\u0633\u0627\u0644 \u0628\u0631\u064a\u062f \u0625\u0644\u0643\u062a\u0631\u0648\u0646\u064a \u0644\u0625\u0639\u0627\u062f\u0629 \u062a\u0639\u064a\u064a\u0646 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0625\u0644\u0649 ${e.email}\u061f`,onConfirm:async()=>{S(!1),g(!0),N(""),v("");try{await(0,c.J1)(o,e.email),v("\u062a\u0645 \u0625\u0631\u0633\u0627\u0644 \u0631\u0627\u0628\u0637 \u0625\u0639\u0627\u062f\u0629 \u062a\u0639\u064a\u064a\u0646 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0625\u0644\u0649 \u0628\u0631\u064a\u062f\u0643 \u0627\u0644\u0625\u0644\u0643\u062a\u0631\u0648\u0646\u064a. \u064a\u0631\u062c\u0649 \u0627\u0644\u062a\u062d\u0642\u0642 \u0645\u0646 \u0635\u0646\u062f\u0648\u0642 \u0627\u0644\u0648\u0627\u0631\u062f \u0648\u0627\u0644\u0628\u0631\u064a\u062f \u0627\u0644\u0645\u0632\u0639\u062c.")}catch(s){console.error("Password reset error:",s),N("\u0641\u0634\u0644 \u0641\u064a \u0625\u0631\u0633\u0627\u0644 \u0631\u0627\u0628\u0637 \u0625\u0639\u0627\u062f\u0629 \u062a\u0639\u064a\u064a\u0646 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631: "+s.message)}finally{g(!1)}},onCancel:()=>S(!1),showCancelButton:!0}),S(!0)):N("\u0644\u0627 \u064a\u0648\u062c\u062f \u0628\u0631\u064a\u062f \u0625\u0644\u0643\u062a\u0631\u0648\u0646\u064a \u0644\u0625\u0639\u0627\u062f\u0629 \u062a\u0639\u064a\u064a\u0646 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631.")},[e,o]);return f?(0,d.jsx)("p",{className:"loading-message",children:"\u062c\u0627\u0631\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0645\u0644\u0641 \u0627\u0644\u0634\u062e\u0635\u064a..."}):e?(0,d.jsxs)("div",{className:"user-profile-container page-container",children:[(0,d.jsx)("h2",{className:"profile-title",children:"\u0645\u0644\u0641\u064a \u0627\u0644\u0634\u062e\u0635\u064a"}),b&&(0,d.jsx)("p",{className:"error-message",children:b}),C&&(0,d.jsx)("p",{className:"success-message",children:C}),(0,d.jsxs)("div",{className:"profile-details card",children:[(0,d.jsxs)("div",{className:"detail-item",children:[(0,d.jsx)("strong",{children:"\u0627\u0644\u0628\u0631\u064a\u062f \u0627\u0644\u0625\u0644\u0643\u062a\u0631\u0648\u0646\u064a:"})," ",(0,d.jsx)("span",{children:e.email})]}),(0,d.jsxs)("div",{className:"detail-item",children:[(0,d.jsx)("strong",{children:"\u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0629:"})," ",(0,d.jsx)("span",{children:s})]}),(0,d.jsxs)("div",{className:"detail-item",children:[(0,d.jsx)("strong",{children:"\u0627\u0644\u0627\u0633\u0645:"}),y?(0,d.jsxs)("div",{className:"edit-name-section",children:[(0,d.jsx)("input",{type:"text",value:m,onChange:e=>u(e.target.value),className:"edit-input",disabled:f}),(0,d.jsx)("button",{onClick:B,className:"save-button",disabled:f,children:"\u062d\u0641\u0638"}),(0,d.jsx)("button",{onClick:()=>{k(!1),u(m),N(""),v("")},className:"cancel-button",disabled:f,children:"\u0625\u0644\u063a\u0627\u0621"})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{children:m||"\u063a\u064a\u0631 \u0645\u062d\u062f\u062f"}),(0,d.jsx)("button",{onClick:()=>k(!0),className:"edit-button",disabled:f,children:"\u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u0627\u0633\u0645"})]})]}),"teacher"===s&&h.length>0&&(0,d.jsxs)("div",{className:"detail-item",children:[(0,d.jsx)("strong",{children:"\u0627\u0644\u062d\u0644\u0642\u0627\u062a \u0627\u0644\u0645\u0631\u062a\u0628\u0637\u0629:"}),(0,d.jsx)("span",{children:h.join(", ")})]}),"guest"===s&&j.length>0&&(0,d.jsxs)("div",{className:"detail-item",children:[(0,d.jsx)("strong",{children:"\u0627\u0644\u0637\u0644\u0627\u0628 \u0627\u0644\u0645\u0631\u062a\u0628\u0637\u0648\u0646:"}),(0,d.jsx)("span",{children:j.join(", ")})]})]}),(0,d.jsx)("div",{className:"profile-actions card",children:(0,d.jsx)("button",{onClick:O,className:"reset-password-button",disabled:f,children:"\u0625\u0639\u0627\u062f\u0629 \u062a\u0639\u064a\u064a\u0646 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631"})}),(0,d.jsx)(r.A,{isOpen:w,title:E.title,message:E.message,onConfirm:E.onConfirm,onCancel:E.onCancel,showCancelButton:E.showCancelButton})]}):(0,d.jsx)("p",{className:"info-message",children:"\u064a\u0631\u062c\u0649 \u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644 \u0644\u0639\u0631\u0636 \u0645\u0644\u0641\u0643 \u0627\u0644\u0634\u062e\u0635\u064a."})}}}]);
//# sourceMappingURL=973.c2a71d68.chunk.js.map