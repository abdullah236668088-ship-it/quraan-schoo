"use strict";(self.webpackChunkquran_memorization_web=self.webpackChunkquran_memorization_web||[]).push([[518],{2673:(e,a,t)=>{t.d(a,{A:()=>n});var s=t(5043),r=t(579);const n=e=>{let{isOpen:a,title:t,message:n,children:l,onConfirm:i,onCancel:d,showCancelButton:o=!0,closeOnOverlayClick:c=!1}=e;const h=(0,s.useRef)(null);if((0,s.useEffect)(()=>{if(a){var e;null===(e=h.current)||void 0===e||e.focus();const a=e=>{"Escape"===e.key&&d()};return document.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",a)}}},[a,d]),!a)return null;return(0,r.jsx)("div",{className:"modal-overlay",onClick:e=>{c&&h.current&&!h.current.contains(e.target)&&d()},children:(0,r.jsxs)("div",{className:"modal-content",ref:h,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title","aria-describedby":"modal-message",tabIndex:"-1",children:[(0,r.jsx)("h3",{id:"modal-title",className:"modal-title",children:t}),n&&(0,r.jsx)("p",{id:"modal-message",className:"modal-message",children:n}),l&&(0,r.jsx)("div",{className:"modal-body",children:l})," ",(0,r.jsxs)("div",{className:"modal-actions",children:[(0,r.jsx)("button",{onClick:i,className:"modal-confirm-button",children:"\u062a\u0623\u0643\u064a\u062f"}),o&&(0,r.jsx)("button",{onClick:d,className:"modal-cancel-button",children:"\u0625\u0644\u063a\u0627\u0621"})]})]})})}},6518:(e,a,t)=>{t.r(a),t.d(a,{default:()=>h});var s=t(5043),r=t(4973),n=t(6667),l=t(6058),i=t(7304),d=(t(2673),t(579));i.t1.register(i.PP,i.kc,i.E8,i.FN,i.No,i.hE,i.m_,i.s$);const o={loading:!1,error:"",message:"",student:null,allReports:[],lastWeekReport:null,lastMonthStats:null,lastWeekChartData:null,lastMonthChartData:null,motivationalMessage:""};function c(e,a){switch(a.type){case"SEARCH_START":return{...o,loading:!0};case"SEARCH_SUCCESS":return{...e,loading:!1,...a.payload};case"SEARCH_FAILURE":return{...o,loading:!1,error:a.payload};case"SEARCH_NOT_FOUND":return{...o,loading:!1,message:a.payload};case"CLEAR_SEARCH":return{...o};default:return e}}function h(){const[e,a]=(0,s.useState)(""),[t,i]=(0,s.useReducer)(c,o),{loading:h,error:m,message:p,student:u,allReports:g,lastWeekReport:x,lastMonthStats:j,lastWeekChartData:v,lastMonthChartData:b,motivationalMessage:N}=t,D=(0,s.useCallback)(e=>{if(!e)return"\u0644\u0627 \u062a\u0648\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u0643\u0627\u0641\u064a\u0629 \u0644\u062a\u0642\u062f\u064a\u0645 \u0631\u0633\u0627\u0644\u0629 \u062a\u062d\u0641\u064a\u0632\u064a\u0629.";const{averageRating:a,totalPagesMemorized:t,totalPartsRevised:s}=e;return a>=90&&t>0?"\u0645\u0627 \u0634\u0627\u0621 \u0627\u0644\u0644\u0647! \u0623\u062f\u0627\u0621 \u0645\u0645\u062a\u0627\u0632 \u0648\u0645\u062c\u0647\u0648\u062f \u0631\u0627\u0626\u0639 \u0641\u064a \u0627\u0644\u062d\u0641\u0638 \u0648\u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629. \u0627\u0633\u062a\u0645\u0631 \u0641\u064a \u0647\u0630\u0627 \u0627\u0644\u0645\u0633\u062a\u0648\u0649 \u0627\u0644\u0645\u062a\u0645\u064a\u0632!":a>=75&&t>0?"\u0623\u062f\u0627\u0621 \u062c\u064a\u062f \u062c\u062f\u064b\u0627! \u062a\u0642\u062f\u0645 \u0645\u0644\u062d\u0648\u0638 \u0641\u064a \u0627\u0644\u062d\u0641\u0638 \u0648\u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629. \u062d\u0627\u0641\u0638 \u0639\u0644\u0649 \u0647\u0630\u0627 \u0627\u0644\u0632\u062e\u0645 \u0648\u0633\u062a\u0635\u0644 \u0625\u0644\u0649 \u0645\u0633\u062a\u0648\u064a\u0627\u062a \u0623\u0639\u0644\u0649.":a>=50&&t>0?"\u062a\u0642\u062f\u0645 \u062c\u064a\u062f. \u0627\u0633\u062a\u0645\u0631 \u0641\u064a \u0627\u0644\u0639\u0645\u0644 \u0627\u0644\u062c\u0627\u062f \u0648\u0631\u0643\u0632 \u0639\u0644\u0649 \u0645\u0631\u0627\u062c\u0639\u0629 \u0645\u0627 \u062d\u0641\u0638\u062a\u0647 \u0644\u062a\u0631\u0633\u064a\u062e\u0647 \u0628\u0634\u0643\u0644 \u0623\u0641\u0636\u0644.":"\u0627\u0628\u062f\u0623 \u0628\u062e\u0637\u0648\u0627\u062a \u0635\u063a\u064a\u0631\u0629 \u0648\u062b\u0627\u0628\u062a\u0629. \u0643\u0644 \u0635\u0641\u062d\u0629 \u0648\u0643\u0644 \u0622\u064a\u0629 \u062a\u062d\u0641\u0638\u0647\u0627 \u0647\u064a \u0625\u0646\u062c\u0627\u0632 \u0639\u0638\u064a\u0645. \u0646\u062d\u0646 \u0647\u0646\u0627 \u0644\u062f\u0639\u0645\u0643!"},[]),C=(0,s.useCallback)(e=>{const a=new Date,t=new Date(a);t.setMonth(t.getMonth()-1),t.getDate()!==a.getDate()&&t.setDate(0);const s=e.filter(e=>{var s;const r=null!==(s=e.reportDate)&&void 0!==s&&s.toDate?e.reportDate.toDate():new Date(e.reportDate);return r>=t&&r<=a});if(0===s.length)return null;let r=0,n=0,l=0,i=0,d=0;s.forEach(e=>{r+=e.pagesMemorized||0,n+=e.partsRevised||0,l+=e.attendanceDays||0,void 0!==e.rating&&null!==e.rating&&(i+=e.rating,d++)});const o=d>0?(i/d).toFixed(2):0,c={};s.forEach(e=>{const a=(e=>{const a=new Date(e),t=a.getDay(),s=a.getDate()-t;return new Date(a.setDate(s))})(e.reportDate.toDate()).toISOString().split("T")[0];c[a]=(c[a]||0)+(e.pagesMemorized||0)});const h=Object.keys(c).sort(),m={labels:h.map(e=>new Date(e).toLocaleDateString("ar-EG",{month:"short",day:"numeric"})),datasets:[{label:"\u0627\u0644\u0635\u0641\u062d\u0627\u062a \u0627\u0644\u0645\u062d\u0641\u0648\u0638\u0629 (\u0634\u0647\u0631\u064a\u064b\u0627)",data:h.map(e=>c[e]),backgroundColor:"rgba(75, 192, 192, 0.6)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1,tension:.3,pointBackgroundColor:"rgba(75, 192, 192, 1)",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(75, 192, 192, 1)"}]};return{totalPagesMemorized:r,totalPartsRevised:n,totalAttendanceDays:l,averageRating:parseFloat(o),lastMonthChartData:m}},[]),y=(0,s.useCallback)(async a=>{if(a.preventDefault(),i({type:"SEARCH_START"}),e.trim())try{const a=(0,n.P)((0,n.rJ)(r.db,"students"),(0,n._M)("name","==",e.trim())),t=await(0,n.GG)(a);if(t.empty)return void i({type:"SEARCH_NOT_FOUND",payload:"\u0644\u0645 \u064a\u062a\u0645 \u0627\u0644\u0639\u062b\u0648\u0631 \u0639\u0644\u0649 \u0637\u0627\u0644\u0628 \u0628\u0647\u0630\u0627 \u0627\u0644\u0627\u0633\u0645."});const s=t.docs[0].data();let l={id:t.docs[0].id,...s};if(l.halaqaId){const e=(0,n.H9)(r.db,"halaqat",l.halaqaId),a=await(0,n.x7)(e);a.exists()?l.halaqaName=a.data().name:l.halaqaName="\u063a\u064a\u0631 \u0645\u062d\u062f\u062f\u0629"}else l.halaqaName="\u063a\u064a\u0631 \u0645\u062d\u062f\u062f\u0629";const d=(0,n.P)((0,n.rJ)(r.db,"weeklyReports"),(0,n._M)("studentId","==",l.id),(0,n.My)("reportDate","desc")),o=(await(0,n.GG)(d)).docs.map(e=>({id:e.id,...e.data()}));let c=null,h=null;o.length>0&&(c=o[0],h={labels:["\u0635\u0641\u062d\u0627\u062a \u0645\u062d\u0641\u0648\u0637\u0629","\u0623\u062c\u0632\u0627\u0621 \u0645\u0631\u0627\u062c\u0639\u0629","\u0623\u064a\u0627\u0645 \u062d\u0636\u0648\u0631","\u062a\u0642\u064a\u064a\u0645"],datasets:[{label:"\u0627\u0644\u062a\u0642\u0631\u064a\u0631 \u0627\u0644\u0623\u0633\u0628\u0648\u0639\u064a \u0627\u0644\u0623\u062e\u064a\u0631",data:[latestReport.pagesMemorized||0,latestReport.partsRevised||0,latestReport.attendanceDays||0,latestReport.rating||0],backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)"],borderWidth:1}]});const m=C(o);i({type:"SEARCH_SUCCESS",payload:{student:l,allReports:o,lastWeekReport:c,lastWeekChartData:h,lastMonthStats:m,lastMonthChartData:m?m.lastMonthChartData:null,motivationalMessage:D(m)}})}catch(t){console.error("Error searching student:",t),i({type:"SEARCH_FAILURE",payload:"\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u0627\u0644\u0628\u062d\u062b \u0639\u0646 \u0627\u0644\u0637\u0627\u0644\u0628: "+t.message})}else i({type:"SEARCH_FAILURE",payload:"\u064a\u0631\u062c\u0649 \u0625\u062f\u062e\u0627\u0644 \u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628 \u0644\u0644\u0628\u062d\u062b."})},[e,C,D]);return(0,d.jsxs)("div",{className:"student-search-guest-container page-container",children:[(0,d.jsx)("h2",{className:"student-search-guest-title",children:"\u0628\u062d\u062b \u0639\u0646 \u0637\u0627\u0644\u0628"}),(0,d.jsxs)("form",{onSubmit:y,className:"search-form",children:[(0,d.jsx)("input",{type:"text",placeholder:"\u0623\u062f\u062e\u0644 \u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628 \u0644\u0644\u0628\u062d\u062b...",value:e,onChange:e=>a(e.target.value),className:"search-input",disabled:h}),(0,d.jsx)("button",{type:"submit",className:"search-button",disabled:h,children:h?"\u062c\u0627\u0631\u064a \u0627\u0644\u0628\u062d\u062b...":"\u0628\u062d\u062b"})]}),m&&(0,d.jsx)("p",{className:"error-message",children:m}),p&&(0,d.jsx)("p",{className:"info-message",children:p}),u&&!h&&(0,d.jsxs)("div",{className:"student-details-section card",children:[(0,d.jsxs)("h3",{children:["\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0637\u0627\u0644\u0628: ",u.name]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("strong",{children:"\u0627\u0644\u062d\u0644\u0642\u0629:"})," ",u.halaqaName||"\u063a\u064a\u0631 \u0645\u062d\u062f\u062f\u0629"]})," ",(0,d.jsxs)("p",{children:[(0,d.jsx)("strong",{children:"\u0627\u0644\u062c\u0646\u0633:"})," ",u.gender]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("strong",{children:"\u0627\u0644\u062d\u0641\u0638 \u0627\u0644\u062d\u0627\u0644\u064a:"})," ",u.memorization||"\u0644\u0627 \u064a\u0648\u062c\u062f"]}),(0,d.jsx)("p",{className:"motivational-message",children:N}),x&&(0,d.jsxs)("div",{className:"last-week-report-card",children:[(0,d.jsxs)("h4",{children:["\u0622\u062e\u0631 \u062a\u0642\u0631\u064a\u0631 \u0623\u0633\u0628\u0648\u0639\u064a (",new Date(x.reportDate.toDate()).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"}),")"]}),(0,d.jsxs)("div",{className:"report-stats-grid",children:[(0,d.jsxs)("div",{className:"stat-item",children:[(0,d.jsx)("h5",{children:"\u0635\u0641\u062d\u0627\u062a \u0645\u062d\u0641\u0648\u0637\u0629"}),(0,d.jsx)("p",{children:x.pagesMemorized||0})]}),(0,d.jsxs)("div",{className:"stat-item",children:[(0,d.jsx)("h5",{children:"\u0623\u062c\u0632\u0627\u0621 \u0645\u0631\u0627\u062c\u0639\u0629"}),(0,d.jsx)("p",{children:x.partsRevised||0})]}),(0,d.jsxs)("div",{className:"stat-item",children:[(0,d.jsx)("h5",{children:"\u0623\u064a\u0627\u0645 \u062d\u0636\u0648\u0631"}),(0,d.jsx)("p",{children:x.attendanceDays||0})]}),(0,d.jsxs)("div",{className:"stat-item",children:[(0,d.jsx)("h5",{children:"\u0627\u0644\u062a\u0642\u064a\u064a\u0645"}),(0,d.jsxs)("p",{children:[x.rating||0,"/100"]})]})]}),v&&(0,d.jsx)("div",{className:"chart-container",children:(0,d.jsx)(l.yP,{data:v,options:{responsive:!0,maintainAspectRatio:!1}})}),(0,d.jsxs)("p",{className:"report-notes",children:[(0,d.jsx)("strong",{children:"\u0645\u0644\u0627\u062d\u0638\u0627\u062a:"})," ",x.notes||"\u0644\u0627 \u062a\u0648\u062c\u062f \u0645\u0644\u0627\u062d\u0638\u0627\u062a."]})]}),j&&(0,d.jsxs)("div",{className:"last-month-stats-card",children:[(0,d.jsx)("h4",{children:"\u0625\u062d\u0635\u0627\u0626\u064a\u0627\u062a \u0622\u062e\u0631 \u0634\u0647\u0631"}),(0,d.jsxs)("div",{className:"stat-cards-grid",children:[(0,d.jsxs)("div",{className:"stat-card",children:[(0,d.jsx)("h5",{children:"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u062d\u0641\u0638"}),(0,d.jsx)("p",{children:j.totalPagesMemorized})]}),(0,d.jsxs)("div",{className:"stat-card",children:[(0,d.jsx)("h5",{children:"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629"}),(0,d.jsx)("p",{children:j.totalPartsRevised})]}),(0,d.jsxs)("div",{className:"stat-card",children:[(0,d.jsx)("h5",{children:"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u062d\u0636\u0648\u0631"}),(0,d.jsx)("p",{children:j.totalAttendanceDays})]}),(0,d.jsxs)("div",{className:"stat-card",children:[(0,d.jsx)("h5",{children:"\u0645\u062a\u0648\u0633\u0637 \u0627\u0644\u062a\u0642\u064a\u064a\u0645"}),(0,d.jsxs)("p",{children:[j.averageRating,"/100"]})]})]}),b&&(0,d.jsx)("div",{className:"chart-container",children:(0,d.jsx)(l.N1,{data:b,options:{responsive:!0,maintainAspectRatio:!1}})})]}),g.length>1&&(0,d.jsxs)("div",{className:"previous-reports-section card",children:[(0,d.jsx)("h4",{children:"\u0627\u0644\u062a\u0642\u0627\u0631\u064a\u0631 \u0627\u0644\u0633\u0627\u0628\u0642\u0629"}),(0,d.jsx)("div",{className:"table-responsive",children:(0,d.jsxs)("table",{className:"reports-table",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"\u0627\u0644\u062a\u0627\u0631\u064a\u062e"}),(0,d.jsx)("th",{children:"\u0635\u0641\u062d\u0627\u062a \u0627\u0644\u062d\u0641\u0638"}),(0,d.jsx)("th",{children:"\u0623\u062c\u0632\u0627\u0621 \u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629"}),(0,d.jsx)("th",{children:"\u0623\u064a\u0627\u0645 \u0627\u0644\u062d\u0636\u0648\u0631"}),(0,d.jsx)("th",{children:"\u0627\u0644\u062a\u0642\u064a\u064a\u0645"}),(0,d.jsx)("th",{children:"\u0645\u0644\u0627\u062d\u0638\u0627\u062a"})]})}),(0,d.jsx)("tbody",{children:g.slice(1).map(e=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{children:new Date(e.reportDate.toDate()).toLocaleDateString("ar-EG")}),(0,d.jsx)("td",{children:e.pagesMemorized||0}),(0,d.jsx)("td",{children:e.partsRevised||0}),(0,d.jsx)("td",{children:e.attendanceDays||0}),(0,d.jsxs)("td",{children:[e.rating||0,"/100"]}),(0,d.jsx)("td",{children:e.notes||"\u0644\u0627 \u064a\u0648\u062c\u062f"})]},e.id))})]})})]}),!x&&!j&&(0,d.jsx)("p",{className:"info-message",children:"\u0644\u0627 \u062a\u0648\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u062a\u0642\u0627\u0631\u064a\u0631 \u0645\u0641\u0635\u0644\u0629 \u0644\u0647\u0630\u0627 \u0627\u0644\u0637\u0627\u0644\u0628 \u0628\u0639\u062f."})]})]})}}}]);
//# sourceMappingURL=518.a51d1437.chunk.js.map